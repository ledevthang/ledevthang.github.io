(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1227:function(t,e,r){var content=r(1272);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(33).default)("f30a6b88",content,!0,{sourceMap:!1})},1271:function(t,e,r){"use strict";r(1227)},1272:function(t,e,r){var o=r(32)(!1);o.push([t.i,"@media screen and (max-width:960px){.product-detail{flex-direction:column;align-items:center}.product-detail>*{width:100%!important;text-align:center;margin:20px 0}#qrid>img{margin:auto}}",""]),t.exports=o},1295:function(t,e,r){"use strict";r.r(e);r(23),r(20),r(28),r(19),r(29);var o=r(4),n=r(10),c=(r(58),r(27),r(8),r(89),r(57),r(87)),l=r(81),d=r.n(l),v=r(192);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,data,n,c,l,v,f,m,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.params,t.store,o=+r.id,e.next=4,d.a.get("https://tomato-chain-default-rtdb.asia-southeast1.firebasedatabase.app/product.json");case 4:return data=e.sent,e.next=7,d.a.get("https://tomato-chain-default-rtdb.asia-southeast1.firebasedatabase.app/diary.json");case 7:for(v in n=e.sent,c=[],l=[],data.data)c.push(h({},data.data[v]));for(f in n.data)l.push(h({},n.data[f]));return m=c.filter((function(t){return t.productID===o}))[0],y=l.filter((function(t){return t.id===o})),console.log(y,"dairyArray"),e.abrupt("return",{product:m,dairyArray:y,id:o});case 16:case"end":return e.stop()}}),e)})))()},data:function(){return{loading:!1,selection:1,url:"",showSuccessDialog:!1,text:"",hash:null,msg:null,valid:!0,role:"Admin",productRule:[function(t){return!!t||"This field cannot be left blank"},function(t){return t&&t.length<=42||"Too long"}],diaryDialog:!1,loadingDiary:!1}},computed:h(h({},Object(c.c)("walletStore",["currentAddress"])),Object(c.c)("companyStore",["allProduct","companyInfo"])),mounted:function(){this.url=window.location.href},methods:{getDate:function(){var t=new Date,e=t.getUTCMonth()+1;return t.getUTCDate()+"/"+e+"/"+t.getUTCFullYear()},updateDairy:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.dairyArray,"dairyArray"),e.next=3,d.a.get("https://tomato-chain-default-rtdb.asia-southeast1.firebasedatabase.app/diary.json");case 3:for(n in r=e.sent,t.dairyArray=[],o=[],r.data)o.push(h({},r.data[n]));t.dairyArray=o.filter((function(e){return e.id===t.id}));case 8:case"end":return e.stop()}}),e)})))()},writeProductDairy:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var data,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loadingDiary=!0,!t.$refs.form.validate()){e.next=19;break}return e.prev=2,e.next=5,v.e(t.id,t.text.toString());case 5:data=e.sent,r={id:t.id,timestamp:t.getDate(),message:t.text.toString(),role:t.role},console.log(data,"data"),setTimeout(Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!data.tx.txHash){e.next=13;break}return t.msg=data.tx.msg,t.hash=data.tx.txHash,r.txHash=data.tx.txHash,t.loadingDiary=!1,t.diaryDialog=!1,t.showSuccessDialog=!0,e.next=9,d.a.post("https://tomato-chain-default-rtdb.asia-southeast1.firebasedatabase.app/diary.json",r);case 9:t.updateDairy(),t.$refs.form.reset(),e.next=18;break;case 13:t.msg=data.tx.msg,t.hash=null,t.loadingDiary=!1,t.diaryDialog=!1,t.showSuccessDialog=!0;case 18:case"end":return e.stop()}}),e)}))),2e3),e.next=19;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),t.msg="Something wrong, please try again XD",t.hash=null,t.loadingDiary=!1,t.diaryDialog=!1,t.showSuccessDialog=!0;case 19:case"end":return e.stop()}}),e,null,[[2,11]])})))()},goToLink:function(t,e){var r=this.$getScanLink(t,e);window.open(r,"_blank")},reserve:function(){var t=this;this.loading=!0,setTimeout((function(){return t.loading=!1}),2e3)},download:function(){var t=document.getElementById("qrid").getElementsByTagName("img")[0].src,e=document.getElementById("download");e.href=t,e.click()}}},y=(r(1271),r(86)),_=r(131),x=r.n(_),w=r(1283),D=r(321),C=r(299),S=r(85),k=r(1149),T=r(1216),O=r(1263),j=r(1164),V=r(1155),P=r(1217),B=r(1282),R=r(187),A=r(238),E=r(301),H=r(1298),z=r(1280),I=r(1154),L=r(1287),M=r(1284),$=r(1285),component=Object(y.a)(m,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("div",[o("h2",{staticClass:"text-center py-6 mb-5",staticStyle:{background:"#c8e4cc","border-radius":"6px"}},[o("b",{staticStyle:{"font-family":"'Montserrat-Bold'","font-size":"30px",color:"#4f5f6e"}},[t._v("\n        PRODUCT DETAILS\n      ")])])]),t._v(" "),o("div",[t.product&&"0"!==t.product.productID?o("div",{staticClass:"product-detail d-flex flex-wrap justify-space-between page my-12"},[o("v-card",{staticClass:"text-center custom-card",staticStyle:{width:"50%"},attrs:{loading:t.loading,"max-width":"374"}},[o("template",{slot:"progress"},[o("v-progress-linear",{attrs:{color:"deep-purple",height:"10",indeterminate:""}})],1),t._v(" "),o("img",{staticClass:"mt-3",attrs:{height:"130",src:r(632)}}),t._v(" "),o("v-card-title",{staticClass:"card-title"},[t._v(t._s(t.product.productName))]),t._v(" "),o("v-card-text",[o("v-row",{staticClass:"mx-0",attrs:{align:"center"}},[o("v-rating",{attrs:{value:0,color:"amber",dense:"","half-increments":"",readonly:"",size:"14"}}),t._v(" "),o("div",{staticClass:"grey--text ms-4"},[t._v("\n            0 (0)\n          ")])],1),t._v(" "),o("div",{staticClass:"mt-4 text-left text-subtitle-1"},[t._v("\n            $ â€¢ Italian, Vegetable\n          ")])],1),t._v(" "),o("v-divider",{staticClass:"mx-4"}),t._v(" "),o("v-card-text",[o("v-chip-group",{attrs:{column:""}},[o("v-chip",[t._v("ID: TMT "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.product.productID))])]),t._v(" "),o("v-chip",[t._v("Product Price: "),o("b",{staticClass:"ml-1"},[t._v("$"+t._s(t.product.productPrice))])]),t._v(" "),o("v-chip",[t._v("Description: "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.product.productDescription))])]),t._v(" "),o("v-chip",[t._v("Date Of Manufacture: "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.product.dateOfManufacture))])]),t._v(" "),o("v-chip",[t._v("Expiration Date: "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.product.expirationDate))])]),t._v(" "),o("v-chip",[t._v("Quantity: "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.product.quantity))])]),t._v(" "),o("v-chip",{on:{click:function(e){return e.stopPropagation(),t.goToLink(t.product.txHash,"tx")}}},[t._v("\n              TxHash: "),o("b",{staticClass:"ml-1"},[t._v(t._s(t.$shortAddress(t.product.txHash,15)))])])],1)],1),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{color:"rgba(40, 167, 69, 0.8)",text:""},on:{click:function(e){return e.stopPropagation(),t.goToLink(t.product.Provider,"address")}}},[o("b",[t._v("Company: "+t._s(t.product.companyName))])])],1)],2),t._v(" "),o("div",{staticClass:"diary-zone"},[o("v-card",{staticClass:"mx-auto",attrs:{"max-width":"400"}},[o("v-card",{staticStyle:{overflow:"unset!important"},attrs:{dark:"",flat:""}},[t.product.Provider===t.currentAddress?o("v-btn",{attrs:{absolute:"",bottom:"",color:"#DEF9EC",right:"",fab:""},on:{click:function(e){t.diaryDialog=!0}}},[o("v-icon",{attrs:{color:"#3BB77E"}},[t._v("mdi-plus")])],1):t._e(),t._v(" "),o("v-img",{attrs:{src:"https://cdn.vuetifyjs.com/images/cards/forest.jpg",gradient:"to top, rgba(0,0,0,.44), rgba(0,0,0,.44)"}},[o("v-container",{staticClass:"fill-height"},[o("v-row",{attrs:{align:"center"}},[o("strong",{staticClass:"text-h1 font-weight-regular mx-6"},[t._v("\n                  "+t._s(t.dairyArray.length)+"\n                ")]),t._v(" "),o("v-row",{attrs:{justify:"end"}},[o("div",{staticClass:"text-h3 font-weight-light mr-6"},[o("b",[t._v("Diary")])])])],1)],1)],1)],1),t._v(" "),o("v-card-text",{staticClass:"py-0",staticStyle:{"min-height":"200px"}},[0!==t.dairyArray.length?o("v-timeline",{attrs:{"align-top":"",dense:""}},t._l(t.dairyArray,(function(e,r){return o("v-timeline-item",{key:r,attrs:{color:"pink",small:""}},[o("v-row",{staticClass:"pt-1"},[o("v-col",{attrs:{cols:"3"}},[o("v-avatar",["Admin"===e.role?o("v-img",{attrs:{src:"https://avataaars.io/?avatarStyle=Circle&topType=LongHairFrida&accessoriesType=Kurt&hairColor=Red&facialHairType=BeardLight&facialHairColor=BrownDark&clotheType=GraphicShirt&clotheColor=Gray01&graphicType=Skull&eyeType=Wink&eyebrowType=RaisedExcitedNatural&mouthType=Disbelief&skinColor=Brown"}}):o("v-img",{attrs:{src:"https://avataaars.io/?avatarStyle=Circle&topType=ShortHairFrizzle&hairColor=Black&facialHairType=MoustacheMagnum&facialHairColor=BrownDark&clotheType=BlazerSweater&clotheColor=Black&eyeType=Default&eyebrowType=FlatNatural&mouthType=Default&skinColor=Black"}})],1)],1),t._v(" "),o("v-col",[o("strong",{staticStyle:{color:"#3BB77E"}},[t._v("\n                  "+t._s(e.role)+"\n                ")]),t._v(" "),o("div",{staticClass:"text-caption"},[o("div",[o("b",[t._v(t._s(e.timestamp))])]),t._v(" "),o("i",[t._v(t._s(e.message))]),o("br"),t._v(" "),o("b",{staticStyle:{color:"#00bcff",cursor:"pointer"},on:{click:function(r){return t.goToLink(e.txHash,"tx")}}},[t._v("see txHash")])])])],1)],1)})),1):t._e()],1)],1)],1),t._v(" "),o("div",{staticStyle:{width:"20%"}},[o("div",{staticStyle:{color:"red","margin-bottom":"20px","font-weight":"bold"}},[t._v("Scan QR to get information of this product")]),t._v(" "),o("qr-code",{attrs:{id:"qrid",text:t.url}}),t._v(" "),o("v-btn",{staticClass:"mt-5",attrs:{rounded:"",color:"#c8e4cc"},on:{click:t.download}},[o("b",[t._v("Download QRcode")])]),t._v(" "),o("a",{attrs:{id:"download",href:"",download:""}})],1)],1):o("div",[t._v("\n      Not found product\n    ")])]),t._v(" "),o("v-dialog",{attrs:{width:"500px"},model:{value:t.diaryDialog,callback:function(e){t.diaryDialog=e},expression:"diaryDialog"}},[o("v-card",{staticStyle:{padding:"10px","text-align":"center"},attrs:{light:""}},[o("div",[o("div",{staticClass:"mb-4"},[o("b",{staticStyle:{color:"#3BB77E","font-size":"18px"}},[t._v("Add your product's diary")])]),t._v(" "),o("v-form",{ref:"form",staticStyle:{width:"100%"},attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[o("v-text-field",{staticStyle:{width:"100%"},attrs:{rules:t.productRule,label:"Your Role",required:"",outlined:""},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}}),t._v(" "),o("v-text-field",{staticStyle:{width:"100%"},attrs:{rules:t.productRule,label:"Diary content",required:"",outlined:""},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),t._v(" "),o("div",{staticClass:"text-left"},[o("i",[t._v("EG: 13/5: sow seeds,...")])])],1),t._v(" "),o("v-card-actions",{staticStyle:{"flex-direction":"column"}},[o("v-spacer"),t._v(" "),o("div",{staticClass:"action-zone",staticStyle:{"margin-bottom":"20px"}},[o("v-btn",{staticClass:"mt-2",attrs:{disabled:!t.valid,loading:t.loadingDiary,rounded:"",color:"#c8e4cc"},on:{click:t.writeProductDairy}},[o("b",[t._v("Write Product's Diary")])])],1)],1)],1)],1),t._v(" "),o("v-dialog",{attrs:{width:"300px"},model:{value:t.showSuccessDialog,callback:function(e){t.showSuccessDialog=e},expression:"showSuccessDialog"}},[o("v-card",{staticStyle:{padding:"10px","text-align":"center"},attrs:{light:""}},[o("v-card-actions",{staticStyle:{"flex-direction":"column"}},[o("div",{staticClass:"text-zone",staticStyle:{width:"100%"}},[o("b",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.msg))]),t._v(" "),t.hash?o("div",[o("a",{attrs:{href:t.$getScanLink(t.hash,"tx")}},[t._v("\n                "+t._s(t.hash)+"\n              ")])]):t._e()]),t._v(" "),o("v-spacer"),t._v(" "),o("div",{staticClass:"action-zone",staticStyle:{margin:"20px 0"}},[o("v-btn",{attrs:{color:"#28a745",medium:"",depressed:"",dark:""},on:{click:function(e){t.showSuccessDialog=!1}}},[t._v("\n              Good!\n            ")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;x()(component,{VAvatar:w.a,VBtn:D.a,VCard:C.a,VCardActions:S.a,VCardText:S.b,VCardTitle:S.c,VChip:k.a,VChipGroup:T.a,VCol:O.a,VContainer:j.a,VDialog:V.a,VDivider:P.a,VForm:B.a,VIcon:R.a,VImg:A.a,VProgressLinear:E.a,VRating:H.a,VRow:z.a,VSpacer:I.a,VTextField:L.a,VTimeline:M.a,VTimelineItem:$.a})}}]);